D5P404-210731
<h2>2021 TuSimple实习日记（中）</h2>
1`TuSimple的实习，第4周写了前端的Vue.js代码，感觉挺简单的，加起来不到200行。第5周周一（7.12）下午给组长做demo，然而开始之前半小时出了个大bug，结果有点尴尬，我当时应该推迟demo的时间的，哎。7.14重新demo，mentor和组长给我的UI、功能和速度又提了些小建议。当然，我个人感觉是，这么个内部工具，要求UI好看之类的是不是有点没必要…
1`有新建议时（比如改dropdown里每个item的名称），经常是看上去只需要加一点代码，但实际上我很多部分都得重写，还好现在我的代码规模本来也不大，所以没关系。7.15，为了加快加载图片的速度，我又搞了个从二进制格式的数据直接在前端显示jpg（而不是加载jpg文件）的小功能。
1`7.16周五，Camera View这个小项目初步完成，就等我mentor发布了。我在git上出了点操作失误，因为涉及rebase等高级的操作，我并不熟悉orz…之后看了些高级git教程、了解了CI、CD的概念，好深奥，为啥学校里没有专门的课教git？？组会上大家讨论了发IPO bonus的事（没听懂）。
1`之后mentor看了我的代码，做了点refactor，提了点建议，主要是各个部件之间传数据要用dict，不要把所有乱七八糟数据都堆在一个array里，还有教我利用好Vue.js的computed property。
2`直到第5周结束，实习节奏都挺慢的，时间线都是自己控制，感觉波澜不惊；我关于实习的日记只有2500字左右，相比之下，我的RAship做满200小时的时候，我已经写了比这多3倍还多的日记。往好了看，是工作轻松、没什么可吐槽的地方；往坏了看，是实习没啥挑战。
2`TuSimple实习群里也没啥人说话，倒是Amazon微信群里很活跃，群聊让我大开眼界。大家讨论了AWS人员大量跑去GCP、有用的内部工具、亚麻员工购物折扣、有公司July 4th放一周假、最好的线上团建游戏、能否带人进公司、新加的2条LP、亚麻内部各种神奇的community、亚麻全职入职后立即可以转组，等等。
2`话说7.8和868聊的时候，他提到TuSimple是个留得住人的公司，所言极是，在这工作的员工都没见怎么跳槽过，比如我mentor。但是7.16，000提供了另一种观点，说这可能是因为员工们想留到上市以后捞一笔，之后还说不定会不会留着呢。他说，一家公司上市之后，目标就可能发生转变，管理层可能套现之后会选择离开，资本也会期望先前的投资得到回报。
1`我这个Map Editor一直是和卡车跑出来的数据打交道，564则是为卡车开始跑之前的准备工作搭平台，包括路线规划等。我没有说动564和我一起去SD办公室看一圈，还是挺可惜的…我想和组里的同事面对面吃个饭聊聊天，有些我好奇问题感觉只能在casual的场景下当面交流（比如他们对公司的看法之类）。
1`7.19，mentor和我聊了下一步的计划。短期看还是些全栈的任务：根据用户的反馈，mentor想给Map Editor加/改几个feature，包括可以在地图里创建comments、展示每个layer的更多信息等。长期来看，他们想把数据库移到AWS上，因为公司内部服务器资源有限。
1`7.23的组会是和Mapping大组的VP一起开的，VP现在已经快60岁了，LinkedIn上写了12条经历，在他近40年的写码生涯里一共“写了一百万行代码”。他见证了AI行业早期的发展，在SWE其他很多领域也积累了经验，真是骨灰级程序员啊。
2`话说7.21，753提醒了我工签的重要性（D5P402），于是我打探了一下截止去年，TuSimple的工签政策：目前了解的情况是，未入职前不给抽H1B（等于少1次抽签机会），且似乎入职后也不100%保证给抽。这个信息十分关键，也更坚定了我秋招跑路的决心。7.26首次在Stanford的图书馆学习。
1`回到我的实习任务。第6周开始（7.19起）我做的项目叫Layer View，也是Map Editor里的一个窗口，这个窗口里是一个列表，列出了所有的“图层”。这个和Photoshop里的图层编辑器很相似，我们也借鉴了它的设计思路。每个图层有各种属性要显示，也有很多按钮提供各种编辑它的方式。
1`Layer View这个部件的代码设计得并不好，可扩展性不高；具体来说，图层分为两类，两种类型公用一个Vue template；不仅如此，图层还分为“root node”和“leaf nodes”，root管理所有图层，leaf则是单个图层，这些仍然公用这个template。两种图层类型的区分、root和leaf的区分，都是用一堆if-else完成的。
1`这样的设计本来目的是提高code reusability，这没问题，但reuse过度的结果就是各部件之间没有独立性。所以在需要修改、添加一些新功能的情况下，mentor提出了让我干脆整个重写一遍Layer View。于是第7周我试着把那个template拆开，但改来改去，越改越不对，到后来都不知道自己在干啥了…
1`我思考了一会，感觉不应该这样改代码，于是决定换一种思路：自己先从头写一遍前端，再把所有功能依次挂载上去。这时我对代码已经比较熟悉，于是重写起来快了不少，心理上也比第7周瞎改旧代码时更享受，用不到20小时搞好，第8周的周四（8.5）提交。这个过程中，我又学了不少Vue.js、CSS、JavaScript知识。
1`重写原先的代码以后，不可避免地引入了新的问题。8.6，mentor说界面变卡了很多，后来他发现是因为我data()里让Vue.js追踪了所有layer objects，这些layers很多都是三维物体，占内存很大。
1`于是我改了data()，只追踪每个layer的id，发生变化时借助EventBus更新，结果总是出奇怪的bug。正在我琢磨其他办法时，8.6下午mentor帮我修了一会，最后只改了2个字（EventBus.$on的第2个参数this.updateIds()，去掉了括号），就修好啦。
1`总的来说，我的实习是按部就班的，明确了前后端的需求以后，我就大概知道要怎样用代码实现了。相比之下，729、770、762、749的实习都是ML方面，都有一些科研性质，就困难得多，主要问题是很难知道model会不会work。
